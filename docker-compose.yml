version: "3.9"

services:
  lab-tracker:
    build: .
    container_name: lab-tracker
    restart: unless-stopped

    ports:
      - "15000:5000"

    environment:
      - FLASK_ENV=production
      - WATCH_PATH=/app/SCAN
      - PRINTER_NAME=Label
      - SITE_URL=https://labtracker.local
      - START_WATCHER=1

    # â¬‡ï¸ command ë¸”ë¡ì€ ë”± í•œ ë²ˆ!
    command: >
      gunicorn --workers 2 --timeout 120 -b 0.0.0.0:5000 labtracker.wsgi:app

    # ğŸ“Œ  í˜¸ìŠ¤íŠ¸ â†” ì»¨í…Œì´ë„ˆ ë””ë ‰í„°ë¦¬ ë§¤í•‘
    volumes:
      # 1) ìŠ¤ìº” í´ë” (ì½ê¸° ì „ìš©)
      - /volume1/SCAN:/app/SCAN:ro

      # 2) ì½”ë“œÂ·í…œí”Œë¦¿ ì‹¤ì‹œê°„ ë°˜ì˜
      - ./labtracker:/app/labtracker:rw

      # 3) DB íŒŒì¼
      - lab_tracker_data:/app/data

volumes:
  lab_tracker_data: